---
layout: post
title: memmory assign & release (0)
tags: 
- text
---

### 도서출처
유영창, 『리눅스 디바이스 드라이버』, 한빛미디어(2010).


# 디바이스 드라이버 초기화와 종료 함수 정리

## open()

|분류|내용|
|:--------:|:--------|
|기능|응용프로그램에서 디바이스 파일을 열었을 때 디바이스를 초기화한다|
|형태|#include<linux/fs.h><br/><br/>int open(struct inode *indoe, struct file *flip);|
|매개변수|1. inode : 열린 디바이스 파일에 대한 정보가 있는 구조체 주소<br/>2. flip : 디바이스 드라이버의 처리 관련 정보가 있는 구조체 주소|
|반환값|성공 : 0<br/> 실패 : 반환값 < 0 <br/> * 에러를 반환 할 때는 응용 프로그램의 open() 함수 반환값으로 그대로 전달되므로 에러 상태에 따른 상수값은 저수준 파일 입출력 함수인 open() 함수의 반환값을 참조해 작성한다|
|&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;||

## release()

|분류|내용|
|:--------:|:--------|
|기능|응용 프로그램에서 디바이스 파일을 닫았을 때 디바이스 드라이버의 사용을 종료한다|
|형태|#include <linux/fs.h><br/><br/>int release(struct inode *inode, struct file *flip);|
|매개변수|1. inode : 열린 디바이스 파일에 대한 정보가 있는 구조체 주소<br/>2. filp : 디바이스 드라이버 처리와 관련된 정보가 있는 구조체 주소|
|반환값|성공 : 0 <br/> 실패 : 반환값 < 0 <br/> * 에러를 반환 할 때는 응용 프로그램의 close()) 함수 반환값으로 그대로 전달되므로 에러 상태에 따른 상수값은 저수준 파일 입출력 함수인 close() 함수의 반환값을 참조해 작성한다, 그러나 대부분의 응용 프로그램에서는 close() 함수의 반환에 따른 처리를 하지 않는다|
|&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;||

## check_region()

|분류|내용|
|:--------:|:--------|
|기능|등록할 수 있는 I/O 영역인지 확인한다|
|형태|#include <linux/ioport.h> <br/><br/> int check_region(unsigned long from, unsigned long extent);|
|설명|등록된 I/O 영역에 중에서 from과 extent가 일치하는 등록 항목이 있는가를 확인한다|
|매개변수|1. from : 확인하고자 하는 I/O 영역의 시작 주소<br/>2. extent : 확인하고자 하는 I/O 영역의 크기|
|반환값| 성공 : 0 <br/> 실패 : 반환값 < 0 and -EBUSY|
|&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;||

##  request_region()

|분류|내용|
|:--------:|:--------|
|기능|I/O 영역을 등록한다|
|형태|#include <linux/ioport.h> <br/><br/> void request_region(unsigned long from, unsigned long extent,const char *name);|
|설명|from 으로 시작되는 I/O영역을 name이라는 이름으로 extent 크기만큼 등록한다 이 영역은 /proc/ioport 파일에서 확인할 수 있다|
|매개변수|1. from : 등록하려는 I/O 영역의 시작 주소<br/>2. extent : from에서 등록하려는 I/O 영역의 크기<br/>3. name : 등록하려는 I/O 영역에 대한 이름 문자열의 선두 주소|
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;||

##  release_region()

|분류|내용|
|:--------:|:--------|
|기능|등록된 I/O 영역을 해제한다|
|형태|#include <linux/ioport.h> <br/><br/> void release_region(unsigned long from, unsigned long extent);|
|설명| 등록된 I/O 영역 중에서 from과 extent가 일치하는 항목을 제거한다|
|매개변수|1. from : 제거하려는 I/O 영역의 시작 주소<br/>2. extent : from에서 제거하려는 I/O 영역의 크기|
|&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;||

## check_mem_region()

|분류|내용|
|:--------:|:--------|
|기능|등록할 수 있는 I/O 메모리 영역인지 확인한다|
|형태|#include <linux/ioport.h><br/><br/>int check_mem_region(unsigned long from, unsigned long extent);|
|설명|등록된 I/O 메모리 영역 중에서 from과 extent가 일치하는 항목이 있는지 확인한다.|
|매개변수|1. from : 확인하고자 하는 I/O 메모리 영역의 시작 주소<br/>2. extent : 확인하고자 하는 I/O 메모리 영역의 크기|
|반환값| 성공 : 0 <br/> 실패 : 반환값 < 0 and -EBUSY|
|&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;||

## request_mem_region()

|분류|내용|
|:--------:|:--------|
|기능|I/O 메모리 영역을 등록한다|
|형태|#include <linux/ioport.h> <br/>void request_mem_region(unsigned long from, unsigned long extent, const chat *name);|
|설명|from으로 시작되는 I/O 영역을 name이라는 이름으로 extent 크기만큼 등록한다. 이 영역은 /proc/iomem 파일에서 확인할 수 있다|
|매개변수|1. from : 등록하려는 I/O 메모리 영역의 시작 주소<br/><br/> 2. extent : from에서 등록하려는 I/O 메모리 영역의 크기<br>3. name : 등록하려는 I/O 메모리 영역에 대한 이름 문자열의 선두 주소|
|&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;||

## release_mem_region()

|분류|내용|
|:--------:|:--------|
|기능|등록된 I/O 영역을 해제한다|
|형태|#include <linux/ioport.h><br/><br/>void release_mem_region(unsigned long from, unsigned long extent);|
|설명|등록된 I/O 메모리 영역 중에서 from과 extent가 일치하는 항목을 제거한다|
|매개변수|1. from : 제거하려는 I/O 메모리 영역의 시작주소<br/>2. extent : 제거하려는 I/O 메모리 영역의 크기|
|&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;||

